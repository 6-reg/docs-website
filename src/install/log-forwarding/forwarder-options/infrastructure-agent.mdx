---
componentType: forwarderSteps
optionType: forwarderSteps
headingText: Install and configure your log forwarder
descriptionText: To complete your log forwarder setup, follow these steps. If you need a different forwarder, select it at the top of this page.
---

How you forward your logs depends on how you installed the infrastructure agent, since the infrastructure agent enables the log forwarding feature. You can install the infrastructure agent via:

* Guided install (recommended for most users)
* Manual installation
* Linux tarball

<CollapserGroup>
<Collapser
    className="freq-link"
    id="system"
    title="Review system requirements"
  >

* Infrastructure agent version 1.11.4 or higher
* [Fluent Bit](https://fluentbit.io/). The infrastructure agent already installs the latest version for you. To update or downgrade it to a specfic version, refer to the [Fluent Bit installation](#install-fb-version) procedures.
* OpenSSL library 1.1.0 or higher
* Built-in support for ARM64 architecture on Linux systems (for example, AWS Graviton architecture) added in infrastructure agent [1.20.6](https://github.com/newrelic/infrastructure-agent/releases/tag/1.20.6).
* Amazon Linux 2
* CentOS version 7 or higher
* Debian version 9 ("Stretch") or higher. Version 11 is not supported.
* SUSE Linux Enterprise Server (SLES) version 12
* Ubuntu versions 16.04.x, 18.04.x and 20.04.x (LTS versions)
* Windows Server 2012, 2016, 2019, and 2022, and their service packs
* Windows 10
</Collapser> 
</CollapserGroup>


## Automatically forward logs with guided install [#infra]

When you use our guided install to install the infrastructure agent, the log forwarding feature is automatically configured during the install process. If you haven't already, create your free New Relic account below to start monitoring your data today.

<InlineSignup/>

To initiate your install, choose your deployment method: 

<TechTileGrid>
  <TechTile
    name="Amazon Linux"
    to="https://one.newrelic.com/marketplace?state=8f14e646-461e-b010-4675-3a0658bb3d20"
    icon={<img src={infrastructureAmazonLinux} alt="Amazon Linux" variant="TechTile"/>}
  />

  <TechTile
    name="Ansible"
    to="/docs/infrastructure/new-relic-infrastructure/config-management-tools/configure-new-relic-infrastructure-using-ansible"
    icon={<img src={osAnsibleRed} alt="Ansible" variant="TechTile"/>}
  />

  <TechTile
    name="CentOS"
    to="https://one.newrelic.com/marketplace?state=8f14e646-461e-b010-4675-3a0658bb3d20"
    icon={<img src={infrastructureCentos} alt="CentOS" variant="TechTile"/>}
  />

  <TechTile
    name="Debian"
    to="https://one.newrelic.com/marketplace?state=8f14e646-461e-b010-4675-3a0658bb3d20"
    icon={<img src={infrastructureDebian} alt="Debian" variant="TechTile"/>}
  />

  <TechTile
    name="RHEL"
    to="https://one.newrelic.com/marketplace?state=8f14e646-461e-b010-4675-3a0658bb3d20"
    icon={<img src={infrastructureRedhat} alt="Red Hat" variant="TechTile"/>}
  />

  <TechTile
    name="SLES"
    to="https://one.newrelic.com/marketplace?state=8f14e646-461e-b010-4675-3a0658bb3d20"
    icon={<img src={infrastructureSuse} alt="SLES" variant="TechTile"/>}
  />

  <TechTile
    name="Ubuntu"
    to="https://one.newrelic.com/marketplace?state=8f14e646-461e-b010-4675-3a0658bb3d20"
    icon={<img src={infrastructureUbuntu} alt="Ubuntu" variant="TechTile"/>}
  />

  <TechTile
    name="Windows"
    to="https://one.newrelic.com/marketplace?state=a792b092-300f-a5a4-ff62-510f4e0c52a5"
    icon={<img src={infrastructureWindows} alt="Windows" variant="TechTile"/>}
  />
</TechTileGrid>

## Enable log forwarding on agent installed manually [#manual]

To install the infrastructure agent manually, follow our [tutorial to install the package manager](/docs/infrastructure/install-infrastructure-agent/linux-installation/install-infrastructure-agent-linux-using-package-manager), or check out our [MSI installer](/docs/infrastructure/install-configure-manage-infrastructure/windows-installation/install-infrastructure-windows-server-using-msi-installer) (Windows). 

### Step 1. Configure the infrastructure agent 

Configuration files direct your system to forward the log sources you want to appear in New Relic. You can add as many config files as you want. Our infrastructure agent uses `.yml` files to configure logging. If you install the infrastructure agent via [Add data](https://one.newrelic.com/marketplace?state=78678a7f-91c5-ca40-ac55-e6b74a50085c) in the UI, the file `logging.yml` is created automatically.

To add a new configuration file for the log forwarding feature:

1. Navigate to the log forwarder configuration folder:

   * Linux: `/etc/newrelic-infra/logging.d/`
   * Windows: `C:\Program Files\New Relic\newrelic-infra\logging.d\`

2. Create a `logging.yml` configuration file, and add the parameters you need. The `logging.d` directory has various `.yml.example` files you can use as a reference or starting point.

The agent automatically processes new configuration files without having to restart the infrastructure monitoring service. The only exception to this is when configuring a custom Fluent Bit configuration.

### Step 2. Set log forwarding parameters [#parameters]

You're required to set up a `name` and log source parameter in the log forwarding `.yml` config file. To start, define a `name` of the log or logs you want to forward to New Relic. 

What you use for the log source depends on the location your logs are sourced from. Available options for the log source include:

<CollapserGroup>
  <Collapser
    id="file"
    title="file"
  >
    Path to the log file or files. The agent tracks changes on the log files in a way similar to `tail -f` shell.

    **Example:**

    ```
    logs:
      - name: example-log
        file: /var/log/example.log # Path to a single log file
      - name: example-log-two
        file: /var/log/example-two.log # Path to another single log file
    ```

    The `file` parameter can point to a specific log file or multiple files by using wildcards applied to names and extensions; for example, `/logs/*.log`. You can use wildcards in place of directories in a file path, which can be used to tail files located in different directories.

    **Example:**

    ```
    logs:
      - name: docker-logs
        file: /var/lib/docker/containers/*/*.log # Path to multiple folders and files
    ```

    <Callout variant="important">
      Use of wildcards may significantly increase the number of file descriptors and inotify watches the Fluent Bit process keeps open, which can interfere with log collection if the host's file descriptor limit is reached. Tailing a large number of files may require you to increase the maximum number of file descriptors and inotify watchers allowed by the operating system. Please refer to [Errors when tailing a large amount of log files](#too-many-files) for more details on how to increase them.
    </Callout>
  </Collapser>

  <Collapser
    id="systemd"
    title="systemd"
  >
    Use the `systemd` parameter to forward log messages that are collected by the `journald` daemon in Linux environments. This input type requires the agent to run in [root mode](/docs/infrastructure/install-configure-infrastructure/linux-installation/linux-agent-running-modes).

    **Example:**

    ```
    logs:
      - name: systemd-example
        systemd: cupsd
    ```
  </Collapser>

  <Collapser
    id="syslog"
    title="syslog"
  >
    Syslog data source.

    **Parameters:**

    * `uri:` Syslog socket. Format varies depending on the protocol:
      * TCP/UDP network sockets: `[tcp/udp]://LISTEN_ADDRESS:PORT`
      * Unix domain sockets: `unix_[tcp/udp]:// + /socket/path`
    * `parser:` Syslog parser. Default is `rfc3164`. Use `rfc5424` if your messages include fractional seconds. Note: `rfc3164` currently does not work on SuSE.
    * `unix_permissions:` default is `0644` for domain sockets; this limits entries to processes running as root. You can use `0666` to listen for non-root processes, at your own risk.

      When running the agent in [privileged mode](/docs/infrastructure/install-configure-infrastructure/linux-installation/linux-agent-running-modes), ports and sockets must be available or owned by `nri-agent`, with `0666` file permissions, so that other processes can write logs to the sockets.

      ```
      logs:
        # TCP network socket
        - name: syslog-tcp-test
          syslog:
            uri: tcp://0.0.0.0:5140 # Use the tcp://LISTEN_ADDRESS:PORT format
            parser: rfc5424 # Default syslog parser is rfc3164
        # UDP network socket
        - name: syslog-udp-test
          syslog:
            uri: udp://0.0.0.0:6140 # Use the udp://LISTEN_ADDRESS:PORT format
          max_line_kb: 35
        # Unix TCP domain socket
        - name: syslog-unix-tcp-test
          syslog:
            uri: unix_tcp:///var/unix-tcp-socket-test
            unix_permissions: 0666 # Default is 0644. Change at your own risk
        # Unix UDP domain socket
        - name: syslog-unix-udp-test
          syslog:
            uri: unix_udp:///var/unix-udp-socket-test
            parser: rfc5424
      ```
  </Collapser>

  <Collapser
    id="tcp"
    title="tcp"
  >
    Logs retrieved over TCP connections.

    **Parameters:**

    * `uri:` TCP/IP socket to listen for incoming data. The URI format is `tcp://LISTEN_ADDRESS:PORT`
    * `format:` format of the data. It can be `json` or `none`.
    * `separator:` If `format: none` is used, you can define a separator string for splitting records (default: `\n`).

      ```
      logs:
        - name: tcp-simple-test
          tcp:
            uri: tcp://0.0.0.0:1234 # Use the tcp://LISTEN_ADDRESS:PORT format
            format: none # Raw text - this is default for 'tcp'
            separator: \t # String for separating raw text entries
          max_line_kb: 32
        - name: tcp-json-test
          tcp:
            uri: tcp://0.0.0.0:2345 # Use the tcp://LISTEN_ADDRESS:PORT format
            format: json
      ```
  </Collapser>

  <Collapser
    id="winevtlog"
    title="winevtlog"
  >
    <Callout variant="important">
      Available since infrastructure agent v.1.24.3
    </Callout>

    Collect event from Windows log channels using new Windows Event Log API using the [winevtlog Fluent Bit plugin](https://docs.fluentbit.io/manual/pipeline/inputs/windows-event-log-winevtlog).

    **Parameters:**

    * `channel:` name of the channel logs will be collected from.
    * `collect-eventids:` a list of Windows Event IDs to be collected and forwarded to New Relic. Event ID ranges are supported.
    * `exclude-eventids:` a list of Windows Event IDs to be excluded from collection. Event ID ranges are supported.

      All events are collected from the specified channel by default. Configure the `collect-eventids` and `exclude-eventids` sections to avoid sending unwanted logs to your New Relic account.

      Add event IDs or ranges to `collect-eventids` or `exclude-eventids` to forward or drop specific events. `exclude-eventids` takes precedence over `collect-eventids` if the same event ID is present in both sections.

      **Example:**

      ```
      logs:
       # Winevtlog log ingestion with eventId filters.
        - name: windows-security
          winevtlog:
            channel: Security
            collect-eventids:
              - 4624
              - 4265
              - 4700-4800
            exclude-eventids:
              - 4735

       # entries for the application, system, powershell, and SCOM channels
        - name: windows-application
          winevtlog:
            channel: Application
        - name: windows-system
          winevtlog:
            channel: System
        - name: windows-pshell
          winevtlog:
            channel: Windows Powershell
        - name: scom
          winevtlog:
            channel: Operations Manager

       # Entry for Windows Defender Logs
        - name: windows-defender
          winevtlog:
            channel: Microsoft-Windows-Windows Defender/Operational

       # Entry for Windows Clustering Logs
        - name: windows-clustering
          winevtlog:
            channel: Microsoft-Windows-FailoverClustering/Operational

       # Entry for IIS logs with logtype attribute for automatic parsing
        - name: iis-log
          file: C:\inetpub\logs\LogFiles\w3svc.log
          attributes:
            logtype: iis_w3c
      ```
  </Collapser>

  <Collapser
    id="winlog"
    title="winlog"
  >
    <Callout variant="important">
    Winlog can only collect classic Event logs. Attempting to capture others will silently collect the Applications log.
    </Callout>
    Collect events from Windows log channels.

    **Parameters:**

    * `channel:` name of the channel logs will be collected from. It doesn't work for custom channels.
    * `collect-eventids:` a list of Windows Event IDs to be collected and forwarded to New Relic. Event ID ranges are supported.
    * `exclude-eventids:` a list of Windows Event IDs to be excluded from collection. Event ID ranges are supported.

      All events are collected from the specified channel by default. Configure the `collect-eventids` and `exclude-eventids` sections to avoid sending unwanted logs to your New Relic account.

      Add event IDs or ranges to `collect-eventids` or `exclude-eventids` to forward or drop specific events. `exclude-eventids` takes precedence over `collect-eventids` if the same event ID is present in both sections.

      **Example:**

      ```
      logs:
       # Winlog log ingestion with eventId filters.
        - name: windows-security
          winlog:
            channel: Security
            collect-eventids:
              - 4624
              - 4265
              - 4700-4800
            exclude-eventids:
              - 4735

       # entries for the application, system, powershell, and SCOM channels
        - name: windows-application
          winlog:
            channel: Application
        - name: windows-system
          winlog:
            channel: System
        - name: windows-pshell
          winlog:
            channel: Windows Powershell
        - name: scom
          winlog:
            channel: Operations Manager

       # Entry for Windows Defender Logs
        - name: windows-defender
          winlog:
            channel: Microsoft-Windows-Windows Defender/Operational

       # Entry for Windows Clustering Logs
        - name: windows-clustering
          winlog:
            channel: Microsoft-Windows-FailoverClustering/Operational

       # Entry for IIS logs with logtype attribute for automatic parsing
        - name: iis-log
          file: C:\inetpub\logs\LogFiles\w3svc.log
          attributes:
            logtype: iis_w3c
      ```
  </Collapser>
</CollapserGroup>

### Step 3. Define key attributes [#optional-config]

Although these configuration parameters aren't required, we still recommend you apply these configurations to your `logging.yml` file so you get the most out of log forwarding.

<CollapserGroup>
  <Collapser
    id="attributes"
    title="attributes"
  >
    List of custom attributes specified as key-value pairs that can be used to send additional data with the logs which you can then query. The `attributes` configuration parameter can be used with any log source.

    <Callout variant="important">
      The `attributes` configuration parameter does not add custom attributes to logs forwarded via external Fluent Bit configuration (for example, using the `fluentbit` configuration parameter). In this scenario, you should refer to the `record_modifier` option in the [Fluent Bit documentation](https://docs.fluentbit.io/manual/).
    </Callout>

    One common use of the `attributes` configuration parameter is to specify the `logtype` attribute. This attribute allows leveraging one of the [built-in parsing rules](https://docs.newrelic.com/docs/logs/log-management/ui-data/parsing/#built-in-rules) supported by New Relic's log management capabilities.

    **Example:**

    ```
    logs:
     - name: example-file-attributes
       file: /var/log/example.log
       attributes:
         logtype: nginx
         region: example-us-02
         team: A-team
     - name: example-tcp-attributes
       tcp:
         uri: tcp://0.0.0.0:2345
         format: json
       attributes:
         logtype: nginx
         region: example-us-02
         team: B-team
    ```
  </Collapser>

  <Collapser
    id="automatically-inserted-attributess"
    title="attributes automatically inserted by the infrastructure agent"
  >
    The infrastructure agent automatically inserts log attributes for your convenience. Some of them are inserted for any log record, while others depend on the configuration parameters you used while setting up the log forwarder.

    <table>
      <thead>
        <tr>
          <th style={{ width: "200px" }}>
            Attribute name
          </th>

          <th>
            Description
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `entity.guids`
          </td>

          <td>
            Always inserted.

            The infrastructure agent inserts the [Entity GUID](/attribute-dictionary/span/entityguid) assigned by New Relic to identify the host where it's running. It is available in the `entity.guids` field.

            Note: If the captured logs belong to an application instrumented using APM, the `entity.guids` field contains both the entity GUID of infrastructure, as well as the GUID of APM, separated by a pipe ( | ) delimiter.
          </td>
        </tr>

        <tr>
          <td>
            `fb.input`
          </td>

          <td>
            Always inserted.

            The underlying [Fluent Bit input plugin type](https://docs.fluentbit.io/manual/pipeline/inputs) used to capture the logs. Currently its values are `tail`, `systemd`, `winlog`, `syslog`, and `tcp`.
          </td>
        </tr>

        <tr>
          <td>
            `filePath`
          </td>

          <td>
            Inserted when using the `file` input type.

            Absolute file path of the file being monitored.
          </td>
        </tr>

        <tr>
          <td>
            `hostname`
          </td>

          <td>
            Always inserted.

            The hostname of the machine/VM/container executing the infrastructure agent.
          </td>
        </tr>

        <tr>
          <td>
            `plugin.type`
          </td>

          <td>
            Always inserted.

            Indicates the utility used to capture the logs. In this case, it is the infrastructure agent itself, so this attribute always has the value `nri-agent`.
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser
    id="pattern"
    title="pattern"
  >
    Regular expression for filtering records. Only supported for the `tail`, `systemd`, `syslog`, and `tcp` (only with format `none`) sources.

    This field works in a way similar to `grep -E` in Unix systems. For example, for a given file being captured, you can filter for records containing either `WARN` or `ERROR` using:

    ```
    - name: only-records-with-warn-and-error
      file: /var/log/logFile.log
      pattern: WARN|ERROR
    ```

    No filtering is applied by default.
  </Collapser>

  <Collapser
    id="max_line_kb"
    title="max_line_kb"
  >
    Maximum size of log entries/lines in KB. If log entries exceed the limit, they are skipped. Default is `128`.
  </Collapser>

  <Collapser
    id="fluentbit"
    title="fluentbit"
  >
    External [Fluent Bit](https://fluentbit.io/) configuration and parser files. If defined, they are merged with the existing configuration and parser files generated by the infrastructure agent.

    The infrastructure agent processes the configuration files located in the `logging.d` directory and will generate a run-time Fluent Bit configuration file that contains the appropriate `[INPUT]`, `[FILTER]` and `[OUTPUT]` sections. Optionally, it will also declare an `@INCLUDE` in case you provided an external Fluent Bit configuration file via the `fluentbit` option.

    The runtime file does not define a [`[SERVICE]` section](https://docs.fluentbit.io/manual/administration/configuring-fluent-bit/classic-mode/configuration-file), leaving all default Fluent Bit configuration values. You can still override Fluent Bit's default settings by defining your own `[SERVICE]` section in your external Fluent Bit configuration file and include it via the `fluentbit` option.

    **Parameters:**

    `config_file:` path to an existing Fluent Bit configuration file. Note that any overlapping source results in duplicate messages in New Relic's Logs UI.

    `parsers_file:` path to an existing Fluent Bit parsers file. The following parser names are reserved: `rfc3164`, `rfc3164-local` and `rfc5424`.

    <Callout variant="important">
      The infrastructure agent allows forwarding logs for the most common use cases by defining simple log forwarding configurations in the YAML files in the `logging.d/` directory, as described in this document. These files are internally translated into Fluent Bit configuration files with the correct format and sane configuration defaults. New Relic provides official support for these configuration options, since we ensure that the generated configuration files are correct and operative.

      Nevertheless, for those use cases not covered by our supported configuration options, we provide the possibility to use an externally-generated Fluent Bit configuration and parsers file using the `fluentbit`, `config_file` and `parsers_file` options.

      Note that we cannot guarantee the correct operation of the log forwarded in this case, given that the provided configurations are completely arbitrary, and are not being generated/validated by the agent. Therefore, New Relic does not provide official support for the external configurations specified via these options.
    </Callout>
  </Collapser>
</CollapserGroup>

### Sample configuration file [#running-modes]

Here is an example of a `logging.d/` configuration file in YAML format. For more configuration examples, [see the infrastructure agent repository](https://github.com/newrelic/infrastructure-agent/tree/master/assets/examples/logging).

<CollapserGroup>
  <Collapser
    id="configuration-file"
    title="logging.d/sample.yaml"
  >
    ```
    # Remember to only use spaces for indentation

    logs:
      # Example of 'file' source
      - name: file-with-attributes
        file: /var/log/test.log # Path to a single file or pattern
        attributes: # You can use custom attributes to enrich your data
          logtype: nginx
          team: The A Team
        pattern: Error # Regular expression to filter log entries

      # Example of 'systemd' source (Linux only)
      - name: systemd-example
        systemd: cupsd

      # Examples of 'syslog' source, one per protocol
      # TCP network socket
      - name: syslog-tcp-test
        syslog:
          uri: tcp://0.0.0.0:5140 # Use the tcp://LISTEN_ADDRESS:PORT format
          parser: rfc5424 # Default syslog parser is rfc3164
      # UDP network socket
      - name: syslog-udp-test
        syslog:
          uri: udp://0.0.0.0:6140 # Use the udp://LISTEN_ADDRESS:PORT format
        max_line_kb: 35

      # Paths for Unix sockets are defined by combining protocol and path:
      # unix_udp:// + /path/socket - for example, unix_udp:///tmp/socket
      # Unix TCP domain socket
      - name: syslog-unix-tcp-test
        syslog:
          uri: unix_tcp:///var/unix-tcp-socket-test
          unix_permissions: 0666 # Default is 0644. Change at your own risk
      # Unix UDP domain socket
      - name: syslog-unix-udp-test
        syslog:
          uri: unix_udp:///var/unix-udp-socket-test
          parser: rfc5424

      # Examples of 'tcp' source for formats 'none' and 'json'
      - name: tcp-simple-test
        tcp:
          uri: tcp://0.0.0.0:1234 # Use the tcp://LISTEN_ADDRESS:PORT format
          format: none # Raw text - this is default for 'tcp'
          separator: \t # String for separating raw text entries
        attributes: # You can add custom attributes to any source of logs
          tcpFormat: none
          someOtherAttribute: associatedValue
        max_line_kb: 32
      - name: tcp-json-test
        tcp:
          uri: tcp://0.0.0.0:2345 # Use the tcp://LISTEN_ADDRESS:PORT format
          format: json
        attributes:
          tcpFormat: json
          yetAnotherAttribute: 12345

      # Example of Fluent Bit configuration import
      - name: fluentbit-import
        fluentbit:
          config_file: /path/to/fluentbit.config
          parsers_file: /path/to/fluentbit/parsers.conf
    ```
  </Collapser>
</CollapserGroup>